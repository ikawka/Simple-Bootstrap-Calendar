/*! https://github.com/tlindig/position-calculator */
!function(a){"function"==typeof define&&define.amd?define("position-calculator",["jquery"],a):jQuery.PositionCalculator=a(jQuery)}(function(a){"use strict";function b(a){return"string"==typeof a&&("window"===a?a=q:"document"===a&&(a=r)),a}function c(a){var b=a.split(" ");return{y:t.test(b[0])?b[0]:"top",x:u.test(b[1])?b[1]:"left"}}function d(a,b){return a===b?!0:a&&b?a.top===b.top&&a.left===b.left&&a.height===b.height&&a.width===b.width:!1}function e(b){var c=b[0];if(9===c.nodeType)return{width:b.outerWidth(),height:b.outerHeight(),top:0,left:0};if(a.isWindow(c))return{width:b.outerWidth(),height:b.outerHeight(),top:b.scrollTop(),left:b.scrollLeft()};if(c.preventDefault)return{width:0,height:0,top:c.pageY,left:c.pageX};var d=b.offset();return{width:b.outerWidth(),height:b.outerHeight(),top:d.top,left:d.left}}function f(b,c){var d=b[0];if(9!==d.nodeType){if(a.isWindow(d)&&(c.top=b.scrollTop(),c.left=b.scrollLeft()),d.preventDefault)return c.top=d.pageY,void(c.left=d.pageX);var e=b.offset();c.top=e.top,c.left=e.left}}function g(b){var c,d=b[0];return 9===d.nodeType?(d=s,c={top:0,left:0}):a.isWindow(d)?(d=s,c={top:b.scrollTop(),left:b.scrollLeft()}):c=b.offset(),{width:d.clientWidth,height:d.clientHeight,top:c.top+d.clientTop,left:c.left+d.clientLeft}}function h(b,c){var d,e=b[0];9===e.nodeType?(e=s,d={top:0,left:0}):a.isWindow(e)?(e=s,d={top:b.scrollTop(),left:b.scrollLeft()}):d=b.offset(),c.top=d.top+e.clientTop,c.left=d.left+e.clientLeft}function i(a,b){return{y:parseFloat(a.y)*(v.test(a.y)?b.height/100:1),x:parseFloat(a.x)*(v.test(a.x)?b.width/100:1),mirror:a.mirror}}function j(a,b,c){var d={top:0,left:0,middle:.5*a.height,center:.5*a.width,bottom:a.height,right:a.width};return 0!==b.y&&(d.middle+=b.y,b.mirror?(d.top+="top"!==c.y?-1*b.y:b.y,d.bottom+="bottom"!==c.y?-1*b.y:b.y):(d.top+=b.y,d.bottom+=b.y)),0!==b.x&&(d.center+=b.x,b.mirror?(d.left+="left"!==c.x?-1*b.x:b.x,d.right+="right"!==c.x?-1*b.x:b.x):(d.left+=b.x,d.right+=b.x)),d}function k(a){var b=[];return a.top>0&&b.push("top"),a.left>0&&b.push("left"),a.bottom<0&&b.push("bottom"),a.right<0&&b.push("right"),a.overflow=b.length?b:null,a}function l(a,b){var c={top:a.top-b.top,left:a.left-b.left,bottom:a.top+a.height-(b.top+b.height),right:a.left+a.width-(b.left+b.width),overflow:[]};return k(c)}function m(a,b,c,d){var e,f,g,h={y:b.y,x:b.x},i={y:c.y,x:c.x};if(-1!==d.overflow.indexOf("top")&&(e="top"),-1!==d.overflow.indexOf("bottom")&&(e=e?null:"bottom"),-1!==d.overflow.indexOf("left")&&(f="left"),-1!==d.overflow.indexOf("right")&&(f=f?null:"right"),!e&&!f)return null;switch(a=a===!0?"both":a,g=0,a){case"item":g=1;break;case"target":g=2;break;case"both":g=3}return 1&g&&(e&&(h.y=w[h.y]),f&&(h.x=w[h.x])),2&g&&(e&&(i.y=w[i.y]),f&&(i.x=w[i.x])),{item_at:h,tar_at:i}}function n(a,b,c){var d,e,f,g,h;return h=c?["top","bottom"]:["left","right"],d=a[h[0]],f=b[h[0]],e=-1*a[h[1]],g=-1*b[h[1]],0>d&&(d=0),0>e&&(e=0),0>f&&(f=0),0>g&&(g=0),0>d&&0>e?!0:0>f&&0>g?!1:f+g>d+e}function o(a,b){"all"===b&&(b=!0);var c=a.distance.overflow;if(!c.length)return a;for(var d,e,f=!1,g=!1,h=c.length-1;h>=0;h--)switch(d=c[h]){case"top":case"bottom":(!g&&b===!0||-1!==b.indexOf(d))&&(e=a.distance[d],a.moveBy.y+=e,a.distance.top-=e,a.distance.bottom-=e,g=!0);break;case"left":case"right":(!f&&b===!0||-1!==b.indexOf(d))&&(e=a.distance[d],a.moveBy.x+=e,a.distance.left-=e,a.distance.right-=e,f=!0)}return k(a.distance),a}function p(a){return this instanceof p?(this.options=this.$itm=this.$trg=this.$bnd=this.itmAt=this.trgAt=this.itmPos=this.trgPos=this.bndPos=this.itmOffset=this.trgOffset=null,void this._init(a)):new p(a)}var q=window,r=document,s=r.documentElement,t=/top|middle|bottom/,u=/left|center|right/,v=/%$/,w={left:"right",center:"center",right:"left",top:"bottom",middle:"middle",bottom:"top"};return p.prototype._init=function(d){var e=this.options=a.extend({},p.defaults,d);return e.item?(this.$itm=e.item.jquery?e.item:a(e.item),0===this.$itm.length?null:(this.$trg=e.target&&e.target.jquery?e.target:a(b(e.target)),this.$bnd=e.boundary&&e.boundary.jquery?e.boundary:a(b(e.boundary)),this.itmAt=c(e.itemAt),this.trgAt=c(e.targetAt),this.resize(),this)):null},p.prototype.resize=function(){var a=this.options,b=e(this.$itm),c=this.$trg.length?e(this.$trg):null;if(this.bndPos=this.$bnd.length?g(this.$bnd):null,!this.itmPos||!d(b,this.itmPos)){this.itmPos=b;var f=i(a.itemOffset,b);f.x=-1*f.x,f.y=-1*f.y,this.itmOffset=j(b,f,this.itmAt)}return this.trgPos&&d(c,this.trgPos)||(this.trgPos=c,c&&(this.trgOffset=j(c,i(a.targetOffset,c),this.trgAt))),this},p.prototype.calcVariant=function(a,b){var c={moveBy:null,distance:null,itemAt:null,targetAt:null};if(this.trgPos&&a&&b){var d={top:this.trgPos.top+this.trgOffset[b.y],left:this.trgPos.left+this.trgOffset[b.x]},e={top:d.top-this.itmOffset[a.y],left:d.left-this.itmOffset[a.x],height:this.itmPos.height,width:this.itmPos.width};c.moveBy={y:e.top-this.itmPos.top,x:e.left-this.itmPos.left},c.distance=this.bndPos?l(this.bndPos,e):null,c.itemAt=a.y+" "+a.x,c.targetAt=b.y+" "+b.x}else c.moveBy={y:0,x:0},c.distance=this.bndPos?l(this.bndPos,this.itmPos):null;return c},p.prototype.calculate=function(){if(null===this.itmPos)return null;var a=this.options;f(this.$itm,this.itmPos),this.trgPos&&f(this.$trg,this.trgPos),this.bndPos&&h(this.$bnd,this.bndPos);var b=this.calcVariant(this.itmAt,this.trgAt);if(!b.distance||!b.distance.overflow)return b;if(a.flip&&"none"!==a.flip&&this.trgPos){var c,d=m(a.flip,this.itmAt,this.trgAt,b.distance);if(d){if(c=this.calcVariant(d.item_at,d.tar_at),!c.distance.overflow)return c;var e={y:!1,x:!1};if(e.y=n(c.distance,b.distance,!0),e.x=n(c.distance,b.distance,!1),e.y!==e.x){if(b=this.calcVariant({y:e.y?d.item_at.y:this.itmAt.y,x:e.x?d.item_at.x:this.itmAt.x},{y:e.y?d.tar_at.y:this.trgAt.y,x:e.x?d.tar_at.x:this.trgAt.x}),!b.distance.overflow)return b}else e.y&&e.x&&(b=c)}}return a.stick&&"none"!==a.stick?o(b,a.stick):b},p.defaults={item:null,target:null,boundary:window,itemAt:"top left",targetAt:"top left",itemOffset:{y:0,x:0,mirror:!0},targetOffset:{y:0,x:0,mirror:!0},flip:"none",stick:"none"},p});

/*!
Simple Bootstrap Calendar
Version 0.1.0
https://github.com/ikawka/Simple-Bootstrap-Calendar
by ikawka August 2014
http://bulletproofscript.wordpress.com/
Sources/References
Basic Calendar
http://jszen.blogspot.com/2007/03/how-to-build-simple-calendar-with.html
Prevent Bootstrap dropdown from closing
http://stackoverflow.com/a/19797577
*/
!function(t){function e(t){if(d.changeYear!==!1){var e='<select class="simple-calendar-year form-control">',a=u.getFullYear(),n=[];0!=d.yearRange?n=d.yearRange.split(":"):(n[0]=a-10,n[1]=a+10);for(var i=n[0];i<=n[1];i++)e+='<option value="'+i+'" '+(i==t?"selected":"")+">"+i+"</option>";return e+="</select>",'<div style="width: 40%; text-align: left" class="pull-right">'+e+"</div>"}return'<div style="width: 40%; text-align: center; line-height: 22px" class="pull-right">'+t+"</div>"}function a(t){if(d.changeMonth!==!1){for(var e='<select class="simple-calendar-month form-control">',a=0;a<p.length;a++)e+='<option value="'+a+'" '+(a==t?"selected":"")+">"+p[a]+"</option>";return e+="</select>",'<div style="width: 60%; text-align: right">'+e+"</div>"}return'<div style="width: 60%; text-align: center; line-height: 22px;">'+h[t]+"</div>"}function n(t,e){this.month=isNaN(t)||null==t?u.getMonth():t,this.year=isNaN(e)||null==e?u.getFullYear():e,this.html=""}function i(){var e=u.getMonth(),a=u.getFullYear();e+=1,12==e&&(e=0,a+=1,u.setFullYear(a)),u.setMonth(e),t('[data-id="'+b+'"]').find(".dropdown-menu").empty().append(s())}function r(){var e=u.getMonth(),a=u.getFullYear();e-=1,0>e&&(e=11,a-=1,u.setFullYear(a)),u.setMonth(e),t('[data-id="'+b+'"]').find(".dropdown-menu").empty().append(s())}function l(e,a){u.setFullYear(a),u.setMonth(e),t('[data-id="'+b+'"]').find(".dropdown-menu").empty().append(s())}function s(){var e=u.getMonth(),a=u.getFullYear(),s=new n(e,a);s.generateHTML();var o=t(s.getHTML());return o.find("a.btn-next").click(function(){i()}),o.find("a.btn-prev").click(function(){r()}),o.find("select.simple-calendar-month").change(function(){var e=t(this).val(),a=t('[data-id="'+b+'"]').find(".simple-calendar-year").val();l(e,a)}),o.find("select.simple-calendar-year").change(function(){t('[data-id="'+b+'"]').find(".simple-calendar-month").change()}),o.find("button.btn-calendar-ok").click(function(){t('[data-id="'+b+'"]').find(".simple-calendar-time").change()}),o}function o(t){var e=t.split("T")[0];return e}var d,c=["Su","Mo","Tu","We","Th","Fr","Sa"],h=["January","February","March","April","May","June","July","August","September","October","November","December"],p=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"],f=[31,28,31,30,31,30,31,31,30,31,30,31],u=new Date,g=new Date,m=null,v="",y="12:00 AM",b="";n.prototype.generateHTML=function(){var t=new Date(this.year,this.month,1),n=t.getDay(),i=f[this.month];1==this.month&&(this.year%4==0&&this.year%100!=0||this.year%400==0)&&(i=29);for(var r=a(this.month),l=e(this.year),s='<table class="table table-condense table-striped table-bordered"><tr><th><a class="simple-calendar-move btn-prev glyphicon glyphicon-chevron-left" href="javascript:;"></a></th><th colspan="5" style="text-align:center; padding: '+(d.changeMonth!==!1?"2":"4")+'px;">'+l+" "+r+'</th><th><a class="simple-calendar-move btn-next glyphicon glyphicon-chevron-right" href="javascript:;"></a></th></tr><tr class="calendar-header">',o=0;6>=o;o++)s+='<td class="calendar-header-day">',s+=c[o],s+="</td>";s+="</tr><tr>";for(var h=1,o=0;9>o;o++){for(var p=this.month+1,u=0;6>=u;u++)if(i>=h&&(o>0||u>=n)){var m=this.year+"-"+(10>p?"0"+p:p)+"-"+(10>h?"0"+h:h);s+='<td><a href="javascript:;" class="day-item'+(this.month==g.getMonth()&&this.year==g.getFullYear()&&h==g.getDate()?" today":"")+(m==v?" selected":"")+'" data-date="'+m+'">',s+=h,s+="</a></td>",h++}else s+="<td></td>";if(h>i)break;s+="</tr><tr>"}if(s+="</tr>",1==d.showTime){for(var b="",w="00",x="AM",M="",D=0;24>D;){x=12>D?"AM":"PM",M=0==D?12:10>D?"0"+D:D,M>12&&(M=10>M-12?"0"+(M-12):M-12);var S=M+":"+w+" "+x;b+='<option value="'+(10>D?"0"+D:D)+":"+w+'" '+(y==S?"selected":"")+">"+S+"</option>","30"==w?(w="00",D++):w="30"}s+='<tr><td style="line-height: 22px; font-weight: bold; padding: 2px" align="center" colspan="2">Time: </td><td style="padding: 2px" colspan="3"><select class="simple-calendar-time form-control">'+b+'</select></td><td style="line-height: 22px; font-weight: bold; padding: 2px" align="center" colspan="2"><button type="button" class="btn btn-default btn-xs btn-calendar-ok">Select</button></td></tr>'}s+="</table>",this.html=s},n.prototype.getHTML=function(){return this.html},t.fn.simpleCalendar=function(e){var a={bsBtnClass:"btn-default",defaultText:"Select Date",dateFormat:"YYYY-MM-dd",maxDate:0,yearRange:!1,changeMonth:!1,changeYear:!1,showTime:!1};return d=t.extend({},a,e),u.setHours(0),u.setMinutes(0),u.setSeconds(0),this.each(function(e,a){t(a).hide(),t(a).data("settings",JSON.stringify(d));var n=b=t(a).attr("id"),i=t(this).val();if(isNaN(Date.parse(i))){u=new Date;var r=u.toISOString();v=o(r)}else{u=new Date(Date.parse(i));var r=u.toISOString();v=o(r)}m=t('<div class="dropdown simple-calendar" data-id="'+n+'"><button class="btn '+d.bsBtnClass+' dropdown-toggle" type="button" data-toggle="dropdown"><div class="selected-text">'+d.defaultText+'</div> <span class="caret"></span></button><div class="dropdown-menu" role="menu" style="padding: 0" id="meals-calendar-container"></div></div>').on({"shown.bs.dropdown":function(){this.closable=!0},mousedown:function(e){var a=t(e.target);a.hasClass("day-item")&&(t(this).find(".table a").removeClass("selected"),a.addClass("selected"))},click:function(e){var n=t(e.target);if(this.closable=!0,n.hasClass("simple-calendar-move")||n.is("select")||n.is("option"))this.closable=!1;else if(n.hasClass("day-item")){1==d.showTime&&(this.closable=!1);var i=v=n.attr("data-date");if(1==d.showTime){var r=y=t('[data-id="'+b+'"]').find(".simple-calendar-time option:selected").text();i+=" "+r}if(t.format){var l=t.format.date(new Date(Date.parse(i)).toISOString(),d.dateFormat);t(a).val(l).change()}else t(a).val(i).change()}},"hide.bs.dropdown":function(){var t=this;return setTimeout(function(){t.closable=!0},1e3),this.closable},change:function(e){var n=t(e.target);if(n.hasClass("simple-calendar-time")){1==d.showTime&&(this.closable=!1);var i=v;if(1==d.showTime){var r=y=t('[data-id="'+b+'"]').find(".simple-calendar-time option:selected").text();i+=" "+r}if(t.format){var l=t.format.date(new Date(Date.parse(i)).toISOString(),d.dateFormat);t(a).val(l).change()}else t(a).val(i).change()}},"shown.bs.dropdown.position-calculator":function(e,a){var n=t('[data-id="'+b+'"]').find(".dropdown-menu",e.target),i=a.relatedTarget;n.css({top:0,left:0});var r=new t.PositionCalculator({item:n,target:i,itemAt:"top left",itemOffset:{y:3,x:0,mirror:!0},targetAt:"bottom left",flip:"both"}),l=r.calculate();n.css({top:l.moveBy.y+"px",left:l.moveBy.x+"px"})}}),m.find("button").click(function(){b=t(a).attr("id"),d=JSON.parse(t(a).data("settings")),t(a).change()}),t(a).after(m),t(a).change(function(){var e=t(this).val().replace(/\-/g,"/");if(isNaN(Date.parse(e))){u=new Date;var a=u.toISOString();return v=o(a),void t('[data-id="'+b+'"]').find(".dropdown-menu").empty().append(s())}var n=new Date(e);u=new Date,u.setDate(n.getDate()),u.setMonth(n.getMonth()),u.setFullYear(n.getFullYear());var a=u.toISOString();v=o(a).replace(/\//g,"-"),t.format&&(e=t.format.date(a,d.dateFormat)),t('[data-id="'+b+'"]').find(".selected-text").text(e),t('[data-id="'+b+'"]').find(".dropdown-menu").empty().append(s())})})}}(jQuery);
